var fe=Object.defineProperty,de=Object.defineProperties;var ce=Object.getOwnPropertyDescriptors;var H=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var z=(e,l,t)=>l in e?fe(e,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[l]=t,x=(e,l)=>{for(var t in l||(l={}))G.call(l,t)&&z(e,t,l[t]);if(H)for(var t of H(l))V.call(l,t)&&z(e,t,l[t]);return e},J=(e,l)=>de(e,ce(l));var b=(e,l)=>{var t={};for(var r in e)G.call(e,r)&&l.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&H)for(var r of H(e))l.indexOf(r)<0&&V.call(e,r)&&(t[r]=e[r]);return t};import{computed as u,defineComponent as T,h as S,inject as Q,nextTick as ge,onMounted as $,onUnmounted as me,provide as ve,ref as y,watchEffect as De}from"vue";import{render as E,Features as W}from'../../utils/render.js';import{Keys as Se}from'../../keyboard.js';import{useId as C}from'../../hooks/use-id.js';import{FocusTrap as R}from'../../components/focus-trap/focus-trap.js';import{useInert as X}from'../../hooks/use-inert.js';import{Portal as Z,PortalGroup as ye}from'../portal/portal.js';import{StackMessage as ee,useStackProvider as he}from'../../internal/stack-context.js';import{match as te}from'../../utils/match.js';import{ForcePortalRoot as j}from'../../internal/portal-force-root.js';import{Description as Oe,useDescriptions as be}from'../description/description.js';import{dom as F}from'../../utils/dom.js';import{useOpenClosed as Pe,State as B}from'../../internal/open-closed.js';import{useOutsideClick as Te}from'../../hooks/use-outside-click.js';import{getOwnerDocument as Ee}from'../../utils/owner.js';import{useEventListener as Ce}from'../../hooks/use-event-listener.js';import{Hidden as Re,Features as ke}from'../../internal/hidden.js';import{useDocumentOverflowLockedEffect as we}from'../../hooks/document-overflow/use-document-overflow.js';var Me=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(Me||{});let N=Symbol("DialogContext");function k(e){let l=Q(N,null);if(l===null){let t=new Error(`<${e} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,k),t}return l}let I="DC8F892D-2EBD-447C-A4C8-A03058436FF4",et=T({name:"Dialog",inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},open:{type:[Boolean,String],default:I},initialFocus:{type:Object,default:null},id:{type:String,default:()=>`headlessui-dialog-${C()}`}},emits:{close:e=>!0},setup(e,{emit:l,attrs:t,slots:r,expose:s}){var U;let n=y(!1);$(()=>{n.value=!0});let d=y(0),p=Pe(),c=u(()=>e.open===I&&p!==null?(p.value&B.Open)===B.Open:e.open),g=y(new Set),D=y(null),w=y(null),P=u(()=>Ee(D));if(s({el:D,$el:D}),!(e.open!==I||p!==null))throw new Error("You forgot to provide an `open` prop to the `Dialog`.");if(typeof c.value!="boolean")throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${c.value===I?void 0:e.open}`);let m=u(()=>n.value&&c.value?0:1),M=u(()=>m.value===0),L=u(()=>d.value>1),q=Q(N,null)!==null,le=u(()=>L.value?"parent":"leaf"),K=u(()=>p!==null?(p.value&B.Closing)===B.Closing:!1),ae=u(()=>q||K.value?!1:M.value),re=u(()=>{var a,o,i;return(i=Array.from((o=(a=P.value)==null?void 0:a.querySelectorAll("body > *"))!=null?o:[]).find(f=>f.id==="headlessui-portal-root"?!1:f.contains(F(w))&&f instanceof HTMLElement))!=null?i:null});X(re,ae);let oe=u(()=>L.value?!0:M.value),ne=u(()=>{var a,o,i;return(i=Array.from((o=(a=P.value)==null?void 0:a.querySelectorAll("[data-headlessui-portal]"))!=null?o:[]).find(f=>f.contains(F(w))&&f instanceof HTMLElement))!=null?i:null});X(ne,oe),he({type:"Dialog",enabled:u(()=>m.value===0),element:D,onUpdate:(a,o,i)=>{if(o==="Dialog")return te(a,{[ee.Add](){g.value.add(i),d.value+=1},[ee.Remove](){g.value.delete(i),d.value-=1}})}});let ie=be({name:"DialogDescription",slot:u(()=>({open:c.value}))}),A=y(null),h={titleId:A,panelRef:y(null),dialogState:m,setTitleId(a){A.value!==a&&(A.value=a)},close(){l("close",!1)}};ve(N,h);function _(){var o,i,f;return[...Array.from((i=(o=P.value)==null?void 0:o.querySelectorAll("html > *, body > *, [data-headlessui-portal]"))!=null?i:[]).filter(v=>!(v===document.body||v===document.head||!(v instanceof HTMLElement)||v.contains(F(w))||h.panelRef.value&&v.contains(h.panelRef.value))),(f=h.panelRef.value)!=null?f:D.value]}let ue=u(()=>!(!M.value||L.value));Te(()=>_(),(a,o)=>{h.close(),ge(()=>o==null?void 0:o.focus())},ue);let se=u(()=>!(L.value||m.value!==0));Ce((U=P.value)==null?void 0:U.defaultView,"keydown",a=>{se.value&&(a.defaultPrevented||a.key===Se.Escape&&(a.preventDefault(),a.stopPropagation(),h.close()))});let pe=u(()=>!(K.value||m.value!==0||q));return we(P,pe,a=>{var o;return{containers:[...(o=a.containers)!=null?o:[],_]}}),De(a=>{if(m.value!==0)return;let o=F(D);if(!o)return;let i=new ResizeObserver(f=>{for(let v of f){let O=v.target.getBoundingClientRect();O.x===0&&O.y===0&&O.width===0&&O.height===0&&h.close()}});i.observe(o),a(()=>i.disconnect())}),()=>{let Y=e,{id:a,open:o,initialFocus:i}=Y,f=b(Y,["id","open","initialFocus"]),v=J(x({},t),{ref:D,id:a,role:"dialog","aria-modal":m.value===0?!0:void 0,"aria-labelledby":A.value,"aria-describedby":ie.value}),O={open:m.value===0};return S(j,{force:!0},()=>[S(Z,()=>S(ye,{target:D.value},()=>S(j,{force:!1},()=>S(R,{initialFocus:i,containers:g,features:M.value?te(le.value,{parent:R.features.RestoreFocus,leaf:R.features.All&~R.features.FocusLock}):R.features.None},()=>E({ourProps:v,theirProps:f,slot:O,attrs:t,slots:r,visible:m.value===0,features:W.RenderStrategy|W.Static,name:"Dialog"}))))),S(Re,{features:ke.Hidden,ref:w})])}}}),tt=T({name:"DialogOverlay",props:{as:{type:[Object,String],default:"div"},id:{type:String,default:()=>`headlessui-dialog-overlay-${C()}`}},setup(e,{attrs:l,slots:t}){let r=k("DialogOverlay");function s(n){n.target===n.currentTarget&&(n.preventDefault(),n.stopPropagation(),r.close())}return()=>{let c=e,{id:n}=c,d=b(c,["id"]);return E({ourProps:{id:n,"aria-hidden":!0,onClick:s},theirProps:d,slot:{open:r.dialogState.value===0},attrs:l,slots:t,name:"DialogOverlay"})}}}),lt=T({name:"DialogBackdrop",props:{as:{type:[Object,String],default:"div"},id:{type:String,default:()=>`headlessui-dialog-backdrop-${C()}`}},inheritAttrs:!1,setup(e,{attrs:l,slots:t,expose:r}){let s=k("DialogBackdrop"),n=y(null);return r({el:n,$el:n}),$(()=>{if(s.panelRef.value===null)throw new Error("A <DialogBackdrop /> component is being used, but a <DialogPanel /> component is missing.")}),()=>{let g=e,{id:d}=g,p=b(g,["id"]),c={id:d,ref:n,"aria-hidden":!0};return S(j,{force:!0},()=>S(Z,()=>E({ourProps:c,theirProps:x(x({},l),p),slot:{open:s.dialogState.value===0},attrs:l,slots:t,name:"DialogBackdrop"})))}}}),at=T({name:"DialogPanel",props:{as:{type:[Object,String],default:"div"},id:{type:String,default:()=>`headlessui-dialog-panel-${C()}`}},setup(e,{attrs:l,slots:t,expose:r}){let s=k("DialogPanel");r({el:s.panelRef,$el:s.panelRef});function n(d){d.stopPropagation()}return()=>{let g=e,{id:d}=g,p=b(g,["id"]),c={id:d,ref:s.panelRef,onClick:n};return E({ourProps:c,theirProps:p,slot:{open:s.dialogState.value===0},attrs:l,slots:t,name:"DialogPanel"})}}}),rt=T({name:"DialogTitle",props:{as:{type:[Object,String],default:"h2"},id:{type:String,default:()=>`headlessui-dialog-title-${C()}`}},setup(e,{attrs:l,slots:t}){let r=k("DialogTitle");return $(()=>{r.setTitleId(e.id),me(()=>r.setTitleId(null))}),()=>{let p=e,{id:s}=p,n=b(p,["id"]);return E({ourProps:{id:s},theirProps:n,slot:{open:r.dialogState.value===0},attrs:l,slots:t,name:"DialogTitle"})}}}),ot=Oe;export{et as Dialog,lt as DialogBackdrop,ot as DialogDescription,tt as DialogOverlay,at as DialogPanel,rt as DialogTitle};
