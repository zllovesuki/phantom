var Y=Object.defineProperty;var M=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var q=(t,u,a)=>u in t?Y(t,u,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[u]=a,C=(t,u)=>{for(var a in u||(u={}))U.call(u,a)&&q(t,a,u[a]);if(M)for(var a of M(u))W.call(u,a)&&q(t,a,u[a]);return t};var j=(t,u)=>{var a={};for(var i in t)U.call(t,i)&&u.indexOf(i)<0&&(a[i]=t[i]);if(t!=null&&M)for(var i of M(t))u.indexOf(i)<0&&W.call(t,i)&&(a[i]=t[i]);return a};import{Fragment as Z,computed as v,defineComponent as D,h as G,inject as K,onMounted as F,onUnmounted as z,provide as _,ref as T,watchEffect as ee,watch as te}from"vue";import{Features as J,render as O,omit as le}from'../../utils/render.js';import{useId as Q}from'../../hooks/use-id.js';import{Keys as x}from'../../keyboard.js';import{dom as f}from'../../utils/dom.js';import{match as B}from'../../utils/match.js';import{focusIn as R,Focus as I,FocusResult as H,sortByDomNode as L}from'../../utils/focus-management.js';import{useResolveButtonType as ae}from'../../hooks/use-resolve-button-type.js';import{FocusSentinel as ne}from'../../internal/focus-sentinel.js';import{microTask as re}from'../../utils/micro-task.js';import{Hidden as ue}from'../../internal/hidden.js';import{getOwnerDocument as ie}from'../../utils/owner.js';var se=(a=>(a[a.Forwards=0]="Forwards",a[a.Backwards=1]="Backwards",a))(se||{}),oe=(i=>(i[i.Less=-1]="Less",i[i.Equal=0]="Equal",i[i.Greater=1]="Greater",i))(oe||{});let V=Symbol("TabsContext");function k(t){let u=K(V,null);if(u===null){let a=new Error(`<${t} /> is missing a parent <TabGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(a,k),a}return u}let N=Symbol("TabsSSRContext"),Re=D({name:"TabGroup",emits:{change:t=>!0},props:{as:{type:[Object,String],default:"template"},selectedIndex:{type:[Number],default:null},defaultIndex:{type:[Number],default:0},vertical:{type:[Boolean],default:!1},manual:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(t,{slots:u,attrs:a,emit:i}){var P;let n=T((P=t.selectedIndex)!=null?P:t.defaultIndex),r=T([]),d=T([]),h=v(()=>t.selectedIndex!==null),b=v(()=>h.value?t.selectedIndex:n.value);function m(l){var S;let e=L(s.tabs.value,f),o=L(s.panels.value,f),c=e.filter(p=>{var g;return!((g=f(p))!=null&&g.hasAttribute("disabled"))});if(l<0||l>e.length-1){let p=B(n.value===null?0:Math.sign(l-n.value),{[-1]:()=>1,[0]:()=>B(Math.sign(l),{[-1]:()=>0,[0]:()=>0,[1]:()=>1}),[1]:()=>0});n.value=B(p,{[0]:()=>e.indexOf(c[0]),[1]:()=>e.indexOf(c[c.length-1])}),s.tabs.value=e,s.panels.value=o}else{let p=e.slice(0,l),$=[...e.slice(l),...p].find(X=>c.includes(X));if(!$)return;let A=(S=e.indexOf($))!=null?S:s.selectedIndex.value;A===-1&&(A=s.selectedIndex.value),n.value=A,s.tabs.value=e,s.panels.value=o}}let s={selectedIndex:v(()=>{var l,e;return(e=(l=n.value)!=null?l:t.defaultIndex)!=null?e:null}),orientation:v(()=>t.vertical?"vertical":"horizontal"),activation:v(()=>t.manual?"manual":"auto"),tabs:r,panels:d,setSelectedIndex(l){b.value!==l&&i("change",l),h.value||m(l)},registerTab(l){var c;if(r.value.includes(l))return;let e=r.value[n.value];r.value.push(l),r.value=L(r.value,f);let o=(c=r.value.indexOf(e))!=null?c:n.value;o!==-1&&(n.value=o)},unregisterTab(l){let e=r.value.indexOf(l);e!==-1&&r.value.splice(e,1)},registerPanel(l){d.value.includes(l)||(d.value.push(l),d.value=L(d.value,f))},unregisterPanel(l){let e=d.value.indexOf(l);e!==-1&&d.value.splice(e,1)}};_(V,s);let w=T({tabs:[],panels:[]}),y=T(!1);F(()=>{y.value=!0}),_(N,v(()=>y.value?null:w.value));let E=v(()=>t.selectedIndex);return F(()=>{te([E],()=>{var l;return m((l=t.selectedIndex)!=null?l:t.defaultIndex)},{immediate:!0})}),ee(()=>{if(!h.value||b.value==null||s.tabs.value.length<=0)return;let l=L(s.tabs.value,f);l.some((o,c)=>f(s.tabs.value[c])!==f(o))&&s.setSelectedIndex(l.findIndex(o=>f(o)===f(s.tabs.value[b.value])))}),()=>{let l={selectedIndex:n.value};return G(Z,[r.value.length<=0&&G(ne,{onFocus:()=>{for(let e of r.value){let o=f(e);if((o==null?void 0:o.tabIndex)===0)return o.focus(),!0}return!1}}),O({theirProps:C(C({},a),le(t,["selectedIndex","defaultIndex","manual","vertical","onChange"])),ourProps:{},slot:l,slots:u,attrs:a,name:"TabGroup"})])}}}),we=D({name:"TabList",props:{as:{type:[Object,String],default:"div"}},setup(t,{attrs:u,slots:a}){let i=k("TabList");return()=>{let n={selectedIndex:i.selectedIndex.value},r={role:"tablist","aria-orientation":i.orientation.value};return O({ourProps:r,theirProps:t,slot:n,attrs:u,slots:a,name:"TabList"})}}}),Ee=D({name:"Tab",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:()=>`headlessui-tabs-tab-${Q()}`}},setup(t,{attrs:u,slots:a,expose:i}){let n=k("Tab"),r=T(null);i({el:r,$el:r}),F(()=>n.registerTab(r)),z(()=>n.unregisterTab(r));let d=K(N),h=v(()=>{if(d.value){let e=d.value.tabs.indexOf(t.id);return e===-1?d.value.tabs.push(t.id)-1:e}return-1}),b=v(()=>{let e=n.tabs.value.indexOf(r);return e===-1?h.value:e}),m=v(()=>b.value===n.selectedIndex.value);function s(e){var c;let o=e();if(o===H.Success&&n.activation.value==="auto"){let S=(c=ie(r))==null?void 0:c.activeElement,p=n.tabs.value.findIndex(g=>f(g)===S);p!==-1&&n.setSelectedIndex(p)}return o}function w(e){let o=n.tabs.value.map(S=>f(S)).filter(Boolean);if(e.key===x.Space||e.key===x.Enter){e.preventDefault(),e.stopPropagation(),n.setSelectedIndex(b.value);return}switch(e.key){case x.Home:case x.PageUp:return e.preventDefault(),e.stopPropagation(),s(()=>R(o,I.First));case x.End:case x.PageDown:return e.preventDefault(),e.stopPropagation(),s(()=>R(o,I.Last))}if(s(()=>B(n.orientation.value,{vertical(){return e.key===x.ArrowUp?R(o,I.Previous|I.WrapAround):e.key===x.ArrowDown?R(o,I.Next|I.WrapAround):H.Error},horizontal(){return e.key===x.ArrowLeft?R(o,I.Previous|I.WrapAround):e.key===x.ArrowRight?R(o,I.Next|I.WrapAround):H.Error}}))===H.Success)return e.preventDefault()}let y=T(!1);function E(){var e;y.value||(y.value=!0,!t.disabled&&((e=f(r))==null||e.focus(),n.setSelectedIndex(b.value),re(()=>{y.value=!1})))}function P(e){e.preventDefault()}let l=ae(v(()=>({as:t.as,type:u.type})),r);return()=>{var g;let e={selected:m.value},p=t,{id:o}=p,c=j(p,["id"]),S={ref:r,onKeydown:w,onMousedown:P,onClick:E,id:o,role:"tab",type:l.value,"aria-controls":(g=f(n.panels.value[b.value]))==null?void 0:g.id,"aria-selected":m.value,tabIndex:m.value?0:-1,disabled:t.disabled?!0:void 0};return O({ourProps:S,theirProps:c,slot:e,attrs:u,slots:a,name:"Tab"})}}}),De=D({name:"TabPanels",props:{as:{type:[Object,String],default:"div"}},setup(t,{slots:u,attrs:a}){let i=k("TabPanels");return()=>{let n={selectedIndex:i.selectedIndex.value};return O({theirProps:t,ourProps:{},slot:n,attrs:a,slots:u,name:"TabPanels"})}}}),Oe=D({name:"TabPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:()=>`headlessui-tabs-panel-${Q()}`},tabIndex:{type:Number,default:0}},setup(t,{attrs:u,slots:a,expose:i}){let n=k("TabPanel"),r=T(null);i({el:r,$el:r}),F(()=>n.registerPanel(r)),z(()=>n.unregisterPanel(r));let d=K(N),h=v(()=>{if(d.value){let s=d.value.panels.indexOf(t.id);return s===-1?d.value.panels.push(t.id)-1:s}return-1}),b=v(()=>{let s=n.panels.value.indexOf(r);return s===-1?h.value:s}),m=v(()=>b.value===n.selectedIndex.value);return()=>{var e;let s={selected:m.value},l=t,{id:w,tabIndex:y}=l,E=j(l,["id","tabIndex"]),P={ref:r,id:w,role:"tabpanel","aria-labelledby":(e=f(n.tabs.value[b.value]))==null?void 0:e.id,tabIndex:m.value?y:-1};return!m.value&&t.unmount&&!t.static?G(ue,C({as:"span"},P)):O({ourProps:P,theirProps:E,slot:s,attrs:u,slots:a,features:J.Static|J.RenderStrategy,visible:m.value,name:"TabPanel"})}}});export{Ee as Tab,Re as TabGroup,we as TabList,Oe as TabPanel,De as TabPanels};
